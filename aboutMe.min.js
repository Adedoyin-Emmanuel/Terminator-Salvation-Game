const canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),explosionSound=new Audio;explosionSound.src="explosionSound.wav",explosionSound.volume=1;const backgroundSound=new Audio;function randomNumber(max,min){return Math.floor(Math.random()*(max-min+1))+min}function getDist(x1,y1,x2,y2){let x=x2-x1,y=y2-y1;return Math.sqrt(Math.pow(x,2)+Math.pow(y,2))}backgroundSound.src="backgroundMusic.mp3",backgroundSound.volume=.3,document.body.style.margin=0,document.body.style.padding=0,canvas.height=innerHeight,canvas.width=innerWidth,addEventListener("load",()=>{canvas.height=innerHeight,canvas.width=innerWidth,init()}),addEventListener("resize",()=>{canvas.height=innerHeight,canvas.width=innerWidth,init()});let colorArray=["red","blue","green","lime","orange","gold","purple","gray","white","palevioletred","dodgerblue"];function randomColor(colorArray){return colorArray[Math.floor(Math.random()*colorArray.length)]}let mouse={x:void 0,y:void 0,radius:100,moving:!1},particles,player,frame=0,stars,miniStars,ticker=0,ticker2=0,randomInt=75,randomFrame=50,moons,miniMoons,randomTimeSpawn=80,moon,projectiles,radius=2,gravity=10,worldFrame=70,friction=.99,mouseTrails,vibrator=!1;class Star{constructor(x,y,radius,color){this.x=x,this.y=y,this.radius=radius,this.color=color,this.friction=.99,this.gravity=randomNumber(2,1),this.velocity={dx:randomNumber(5,-3),dy:randomNumber(5,-5)},this.draw=()=>{ctx.save(),ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),ctx.fillStyle=this.color,ctx.fill(),ctx.strokeStyle=this.color,ctx.stroke(),ctx.closePath(),ctx.restore()},this.update=()=>{this.y+this.radius+this.velocity.dy>canvas.height||this.y-this.radius+this.velocity.dy<0?(this.radius--,this.velocity.dy=-this.velocity.dy*this.friction,this.explode()):this.velocity.dy+=this.gravity,this.x+this.radius+this.velocity.dx>canvas.width||this.x-this.radius+this.velocity.dx<0?(this.radius--,this.velocity.dx=-this.velocity.dx*this.friction,this.explode()):this.velocity.dx+=this.gravity,this.y+=this.velocity.dy,this.draw()},this.explode=()=>{for(let z=0;z<10;z++)miniStars.push(new MiniStar(this.x,this.y,2,void 0))}}}class MiniStar{constructor(x,y,radius,color){this.x=x,this.y=y,this.radius=radius,this.color=color,this.gravity=.1,this.ttl=100,this.opacity=1,this.friction=.99,this.velocity={dx:randomNumber(25,-25),dy:randomNumber(25,-25)},this.draw=()=>{ctx.save(),ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),ctx.fillStyle=this.color,ctx.fill(),ctx.strokeStyle=this.color,ctx.stroke(),ctx.closePath(),ctx.restore()},this.update=()=>{this.y+this.radius+this.velocity.dy>canvas.height?this.velocity.dy=-this.velocity.dy*this.friction:this.velocity.dy+=this.gravity,this.x+this.radius+this.velocity.dx>canvas.width?this.velocity.dx=-this.velocity.dx*this.friction:this.velocity.dx+=this.gravity,this.ttl--,this.opacity-=1/this.ttl,this.y+=this.velocity.dy,this.x+=this.velocity.dx,this.draw()}}}class MouseTrail{constructor(x,y,radius,color){this.x=x,this.y=y,this.radius=radius,this.color=color,this.fadeBlur=randomNumber(20,10),this.velocity={dx:randomNumber(2,-2),dy:randomNumber(2,-2)},this.mouse={x:mouse.x,y:mouse.y,radius:mouse.radius},this.mouseDistance={x:this.mouse.x-this.x,y:this.mouse.y-this.y},this.distance=Math.sqrt(Math.pow(this.mouseDistance.x,2)+Math.pow(this.mouseDistance.y,2)),this.maximumDistance=this.mouse.radius,this.force={x:this.mouseDistance.x/this.distance,y:this.mouseDistance.y/this.distance},this.power=(this.maximumDistance-this.distance)/this.maximumDistance,this.direction={x:this.force.x*this.power*this.angle,y:this.force.y*this.power*this.angle},this.angle=randomNumber(.5,.3),this.vibrate=()=>{this.x+=this.velocity.dx*Math.cos(this.angle),this.y+=this.velocity.dy*Math.sin(this.angle)},this.draw=()=>{ctx.save(),ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),ctx.fillStyle=this.color,ctx.strokeStyle=this.color,ctx.shadowColor=this.color,ctx.shadowBlur=this.fadeBlur,ctx.fill(),ctx.stroke(),ctx.closePath(),ctx.restore()},this.update=()=>{this.draw(),this.vibrate(),this.angle++}}}class Moon{constructor(x,y,radius,color){this.x=x,this.y=y,this.radius=radius,this.color=color,this.friction=.98,this.gravity=randomNumber(5,3),this.velocity={dx:randomNumber(15,-15),dy:randomNumber(15,-15)},this.draw=()=>{ctx.save(),ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),ctx.fillStyle=this.color,ctx.strokeStyle=this.color,ctx.shadowColor=this.color,ctx.shadowBlur=25,ctx.fill(),ctx.stroke(),ctx.closePath(),ctx.restore()},this.update=()=>{this.y+this.radius+this.velocity.dy>canvas.height||this.y-this.radius+this.velocity.dy<0?(this.radius--,this.velocity.dy=-this.velocity.dy*this.friction,this.explode()):this.velocity.dy+=this.gravity,this.x+this.radius+this.velocity.dx>canvas.width||this.x-this.radius+this.velocity.dx<0?(this.radius--,this.velocity.dx=-this.velocity.dx*this.friction,this.explode()):this.velocity.dx+=this.gravity,this.y+=this.velocity.dy,this.draw()},this.explode=()=>{for(let g=0;g<10;g++)miniMoons.push(new MiniMoon(this.x,this.y,randomNumber(5,2),void 0))}}}class MiniMoon{constructor(x,y,radius,color){this.x=x,this.y=y,this.radius=radius,this.color=color,this.gravity=3,this.ttl=100,this.opacity=1,this.friction=.99,this.velocity={dx:randomNumber(25,-25),dy:randomNumber(25,-25)},this.draw=()=>{ctx.save(),ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),ctx.fillStyle=this.color,ctx.fill(),ctx.strokeStyle=this.color,ctx.stroke(),ctx.closePath(),ctx.restore()},this.update=()=>{this.y+this.radius+this.velocity.dy>canvas.height?this.velocity.dy=-this.velocity.dy*this.friction:this.velocity.dy+=this.gravity,this.x+this.radius+this.velocity.dx>canvas.width?this.velocity.dx=-this.velocity.dx*this.friction:this.velocity.dx+=this.gravity,this.ttl--,this.opacity-=1/this.ttl,this.y+=this.velocity.dy,this.x+=this.velocity.dx,this.draw()}}}class Particle{constructor(x,y,radius,color){this.x=x,this.y=y,this.radius=radius,this.color=color,this.friction=.9,this.gravity=1,this.angle=0,this.angleSpeed=randomNumber(50,30),this.velocity={dx:randomNumber(5,-5),dy:randomNumber(5,-5)},this.draw=()=>{ctx.save(),ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),ctx.fillStyle=this.color,ctx.fill(),ctx.strokeStyle=this.color,ctx.stroke(),ctx.shadowColor=this.color,ctx.shadowBlur=25,ctx.closePath(),ctx.restore()},this.update=()=>{this.y+=this.velocity.dy,this.x+=this.velocity.dx,this.draw()},addEventListener("mousemove",e=>{mouse.x=e.clientX,mouse.y=e.clientY,mouse.moving=!0;let dx=mouse.x-this.x,dy=mouse.y-this.y,dist=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2)),forceX=dx/dist,forceY=dy/dist,maxDist=mouse.radius,force=(maxDist-dist)/maxDist,directionX=forceX*force*this.angle,directionY=forceY*force*this.angle;getDist(mouse.x,mouse.y,this.x,this.y)<80&&(this.x-=directionX,this.y-=directionY,this.angle+=this.angleSpeed)})}}class Projectile{constructor(x,y,radius,color,velocity){this.x=x,this.y=y,this.radius=radius,this.color=color,this.velocity=velocity,this.alpha=1,this.update=()=>{this.draw(),this.y+=this.velocity.y,this.x+=this.velocity.x,this.y+=gravity,this.velocity.x*=friction,this.velocity.y*=friction,this.alpha-=.009},this.draw=()=>{ctx.save(),ctx.globalAlpha=this.alpha,ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),ctx.fillStyle=this.color,ctx.fill(),ctx.strokeStyle=this.color,ctx.stroke(),ctx.closePath(),ctx.restore()}}}function init(){particles=[],stars=[],miniStars=[],moons=[],miniMoons=[],mouseTrails=[];for(var initParticlesCount=randomNumber(200,100),i=0;i<initParticlesCount;i++){let radius=1,color="white",x=randomNumber(canvas.width-radius,radius),y=randomNumber(canvas.height-radius,radius);particles.push(new Particle(x,y,radius,color))}for(let gt=0;gt<randomNumber(200,50);gt++){var randomRadius=randomNumber(2,1),randomColors=randomColor(colorArray),x=randomNumber(canvas.width-randomRadius,randomRadius),y=randomNumber(canvas.height-randomRadius,randomRadius);mouseTrails.push(new MouseTrail(x,y,randomRadius,randomColors))}projectiles=[];var angle=2*Math.PI/1,explosive=30}function spawnBubbles(){for(let gt=0;gt<randomNumber(200,50);gt++){var randomRadius=randomNumber(2,1),randomColors=randomColor(colorArray),x=randomNumber(canvas.width-randomRadius,randomRadius),y=randomNumber(canvas.height-randomRadius,randomRadius);mouseTrails.push(new MouseTrail(x,y,randomRadius,randomColors))}}function animate(){if(requestAnimationFrame(animate),frame++,ticker++,ticker2++,ctx.save(),ctx.fillStyle="rgba(0,0,0,1)",ctx.fillRect(0,0,innerWidth,innerHeight),ctx.restore(),backgroundSound.play(),ticker++,projectiles.forEach((projectile,projectileIndex)=>{projectile.alpha>0?projectile.update():projectiles.splice(projectileIndex,1)}),mouseTrails.forEach((mouseTrail,mouseTrailIndex)=>{if(mouseTrail.update(),ticker%randomTimeSpawn==0){let x=mouseTrail.x-mouseTrail.radius,y=mouseTrail.y-mouseTrail.radius,particlecount=randomNumber(50,30),smallerRadius=randomNumber(.5,.3),particleincrement=2*Math.PI/particlecount,power=randomNumber(80,40);for(let i=0;i<particlecount;i++)projectiles.push(new Projectile(x,y,smallerRadius,randomColor(colorArray),{x:Math.cos(particleincrement*i)*Math.random()*power,y:Math.sin(particleincrement*i)*Math.random()*power}));mouseTrails.splice(mouseTrailIndex,1)}}),ticker2%worldFrame==0&&(randomExplosion(),explosionSound.play(),worldFrame=randomNumber(200,100)),particles.forEach((particle,particleIndex)=>{particle.color=`hsla(${360*Math.random()},50%,50%)`,particle.update()}),stars.forEach((star,starIndex)=>{star.update(),0==star.radius&&(star.color=`hsla(${360*Math.random()},50%,50%)`,stars.splice(starIndex,1))}),moons.forEach((moon,moonIndex)=>{moon.update(),0==moon.radius&&(moon.color="white",moons.splice(moonIndex,1))}),miniStars.forEach((miniStar,miniStarIndex)=>{0==miniStar.ttl&&miniStars.splice(miniStarIndex,1),miniStar.color=`rgba(${255*Math.random()},${255*Math.random()},${255*Math.random()},${miniStar.opacity})`,miniStar.update()}),miniMoons.forEach((miniMoon,miniMoonIndex)=>{0==miniMoon.ttl&&miniMoons.splice(miniMoonIndex,1),miniMoon.color=`rgba(${255*Math.random()},${255*Math.random()},${255*Math.random()},${miniMoon.opacity})`,miniMoon.update()}),ticker%randomInt==0){for(let d=0;d<1;d++){let radius=randomNumber(15,12),x=randomNumber(canvas.width-radius,radius),y=randomNumber(50-radius,radius),color="white";stars.push(new Star(x,y,radius,color))}randomInt=randomNumber(700,500)}if(ticker%randomTimeSpawn==0){for(let d=0;d<1;d++){let radius=randomNumber(15,12),x=randomNumber(canvas.width-radius,radius),y=randomNumber(50-radius,radius),color="white";moons.push(new Moon(x,y,radius,color))}randomTimeSpawn=randomNumber(700,500)}if(ticker%randomInt==0&&spawnBubbles(),frame%randomFrame==0){var particlesCount=randomNumber(400,300);for(let m=0;m<particlesCount;m++){let radius=1,color="white",x=randomNumber(canvas.width-radius,radius),y=randomNumber(canvas.width-radius,radius);particles.push(new Particle(x,y,radius,color))}randomFrame=randomNumber(400,200)}for(let a=0;a<particles.length;a++)for(let b=0;b<a;b++)getDist(particles[a].x,particles[a].y,particles[b].x,particles[b].y)<100&&(ctx.beginPath(),ctx.moveTo(particles[a].x,particles[a].y),ctx.lineTo(particles[b].x,particles[b].y),ctx.lineWidth=.1,ctx.strokeStyle=`hsla(${255*Math.random()},50%,50%)`,ctx.stroke(),ctx.closePath());for(let a=0;a<miniStars.length;a++)for(let b=0;b<a;b++)getDist(miniStars[a].x,miniStars[a].y,miniStars[b].x,miniStars[b].y)<100&&(ctx.beginPath(),ctx.moveTo(miniStars[a].x,miniStars[a].y),ctx.lineTo(miniStars[b].x,miniStars[b].y),ctx.lineWidth=.2,ctx.strokeStyle="white",ctx.stroke(),ctx.closePath());for(let a=0;a<stars.length;a++)for(let b=0;b<a;b++)getDist(stars[a].x,stars[a].y,stars[b].x,stars[b].y)<500&&(ctx.beginPath(),ctx.moveTo(stars[a].x,stars[a].y),ctx.lineTo(stars[b].x,stars[b].y),ctx.lineWidth=.1,ctx.strokeStyle="white",ctx.stroke(),ctx.closePath())}function randomExplosion(e){let x=randomNumber(canvas.width-20,20),y=randomNumber(canvas.height-20,20),particlecount=400,particleincrement=2*Math.PI/400,power=40;for(let i=0;i<400;i++)projectiles.push(new Projectile(x,y,radius,`hsl(${360*Math.random()},50%,50%)`,{x:Math.cos(particleincrement*i)*Math.random()*40,y:Math.sin(particleincrement*i)*Math.random()*40}))}init(),animate(),addEventListener("click",e=>{mouse.x=e.clientX,mouse.y=e.clientY;const particlecount=400,particleincrement=2*Math.PI/400,power=30;explosionSound.play();for(let i=0;i<400;i++)projectiles.push(new Projectile(mouse.x,mouse.y,radius,`hsl(${360*Math.random()},50%,50%)`,{x:Math.cos(particleincrement*i)*Math.random()*30,y:Math.sin(particleincrement*i)*Math.random()*30}))});